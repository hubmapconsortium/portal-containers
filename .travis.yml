services:
  - docker
language: python
python:
  - "3.8"
cache: pip
before_script:
  - chmod +x ./create_release.sh
script:
  - ./test.sh

after_success:
  - echo "Tests passed, proceeding with the release."

  - if [ "$TRAVIS_BRANCH" == "tkakar/cat-1016-create-git-release" ] || [ "$TRAVIS_BRANCH" == "master" ]; then
      echo "Creating GitHub release...";
      export RELEASE_TOKEN=$RELEASE_TOKEN;
      ./create_release.sh;
    fi

after_failure:
  - echo "Tests failed, skipping release creation."

env:
  global:
    - RELEASE_TOKEN=$RELEASE_TOKEN
dist: focal
